<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>JavaScript ♥ Drupal</title>

        <meta name="description" content="JavaScript in the context of a Drupal site">
        <meta name="author" content="Pierre Buyle">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/default.css" id="theme">

        <!-- For syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section>
                    <h1>JavaScript<br/><large>♥</large><br/>Drupal</h1>
                    <p>
                        <small>by <a href="http://about.me/pbuyle">Pierre Buyle</a> </small>
                    </p>
                </section>
                <section>
                    <section id="adding-javascript">
                    <h2>Adding JavaScript to pages</h2>
                    <p>
                        <ul>
                            <li class="fragment">Include a JavaScript file on every pages of the site.<pre><code class="ini">scripts[] = awesomeness.js</code></pre></li>
                            <li class="fragment">Include JavaScript on a page.<pre><code class="php">drupal_add_js($data, $options)</code></pre></li>
                            <li class="fragment">Include JavaScript on a renderable array.<pre><code class="php">$element['#attached']['js'] = array($data => $options)</code></pre></li>
                        </ul>
                    </p>
                    </section>
                    <section id="dot-info-scripts">
                        <h2>scripts[] in .info files</h2>
                        <p>
                            <pre><code class="ini">scripts[] = awesomeness.js</code></pre>
                            <ul>
                                <li>Add the referenced files on <strong>every page</strong></li>
                                <li>Files are <strong>processed</strong> (aggregated) and <strong>cached</strong></li>
                                <li>Not very flexible but good enough</li>
                            </ul>
                        </p>
                    </section>
                    <section id="drupal-add-js">
                        <h2>drupal_add_js()</h2>
                        <p>
                            <pre><code class="php" data-trim>drupal_add_js('path/to/awesomeness.js', 'file')</code></pre>
                            Add JavaScript to the currently rendered page.
                            <pre class="fragment"><code class="php" data-trim>drupal_add_js('alert("Awesome!");', 'inline');</code></pre>
                            <pre class="fragment"><code class="php" data-trim>drupal_add_js(array('myAwesomeModule' => array(
    'foo' => 'bar',
    'bar' => 'foo',
)), 'setting');</code></pre>
                            <pre class="fragment"><code class="php" data-trim>drupal_add_js('//aweso.me/ness.js', 'external');</code></pre>
                        </p>
                    </section>
                    <section id="drupal-add-js-options">
                        <h2>drupal_add_js()</h2>
                        <p>
                            <pre><code class="php" data-trim>
drupal_add_js('path/to/awesomeness.js', array(
  'type' => 'file',</code></pre>
                            <pre class="fragment"><code class="php">  'scope' => 'footer',</code></pre>
                            <pre class="fragment"><code class="php">  'group' => 'JSTHEME',
  'weigth' => '-10',</code></pre>
                            <pre class="fragment"><code class="php">  'preprocess' => TRUE,
  'every_page' => TRUE,</code></pre>
                            <pre class="fragment"><code class="php">  'defer' => TRUE,
  'cache' => FALSE,</code></pre>
                            <pre><code class="php" data-trim>));</code></pre>
                        </p>
                    </section>
                    <section id="hash-attached">
                        <h2>#attached</h2>
                        <p>
                            <pre><code class="php">$element['#attached']['js'] = array($data => $options);</code></pre>
                            Invoke drupal_add_js($data, $options) when $element is rendered.
                            <pre class="fragment"><code class="php" data-trim>$element['#attached']['js'] = array('path/to/awesomeness.js', 'file')</code></pre>
                            <pre class="fragment"><code class="php" data-trim>$element['#attached']['js'] = array('alert("Awesome!");', 'inline');</code></pre>
                            <pre class="fragment"><code class="php" data-trim>$element['#attached']['js'] = array(array('myAwesomeModule' => array(
    'foo' => 'bar',
    'bar' => 'foo',
)), 'setting');</code></pre>
                            <pre class="fragment"><code class="php" data-trim>$element['#attached']['js'] = array('//aweso.me/ness.js', 'external');</code></pre>

                        </p>
                    </section>
                </section>
                <section>
                    <section id="writing-javascript">
                        <h2>Writing JavaScript</h2>
                        <p>
                            <ul>
                                <li class="fragment">jQuery.noConflict</li>
                                <li class="fragment">Drupal.behaviors</li>
                                <li class="fragment">jQuery.once</li>
                                <li class="fragment">Drupal.settings</li>
                            </ul>
                         </p>
                    </section>
                    <section id="jquery-no-conflict">
                        <h2>jQuery.noConflict</h2>
                        <p>
                            <ul>
                                <li><code>$</code> <strong>is not</strong> the jQuery object.</li>
                                <li class="fragment">Code should be wrapped in an <a href="http://stage.learn.jquery.com/javascript-101/functions/#immediately-invoked-function-expression">Immediately Invoked Function Expression</a>.
                                <pre class="fragment"><code class="javascript" data-trim>
(function($) {
  // Here $ is the jQuery object
})(jQuery);
                                    </code></pre></li>
                                 <li class="fragment">Variables are kept out of the global scope.</li>
                             </ul>
                        </p>
                    </section>
                    <section id="drupal-behaviors">
                        <h2>Drupal.behaviors</h2>
                        <p>
                            Replace <code>$(document).ready()</code> to process elements.
                            <pre><code class="javascript" data-trim>
Drupal.behaviors.doSomething = {
  attach: function(context, settings) {
    // do something here
                            </code></pre>
                            <pre class="fragment"><code class="php">  }
  detach: function(context, settings, trigger) {
    // Clean up here</code></pre>
                            <pre><code class="php">  }
}</code></pre>
                            <div class="fragment">Used by the Drupal AJAX framework and well-behaving contribs.</div>
                            <pre class="fragment"><code class="php" data-trim>
Drupal.attachBehaviors(context, [settings])
Drupal.detachBehaviors(context, [settings], [trigger])</code></pre>
                        </p>
                    </section>
                    <section id="jquery-once">
                        <h2>jQuery.once</h2>
                        <p>
                            <ul>
                            <li>Behaviors could be applied multiple times on the page.</li>
                            <li>Avoid processing the same elements multiple time.</li>
                            </ul>
                            <pre class="fragment"><code class="javascript" data-trim>
$('div.something', context).once('do-something');
                            </code></pre>
                        </p>
                    </section>
                    <section id="drupal-settings">
                        <h2>Drupal.settings</h2>
                        <p>
                          <ul>
                            <li class="fragment">Set from PHP<pre><code class="php" data-trim>drupal_add_js(
  array('myAwesomeModule' => array(
    'foo' => 'bar',
    'bar' => 'foo',
  )
), 'setting');</code></pre></li>
                            <li class="fragment">Get from JavaScript<pre><code class="javascript" data-trim>
Drupal.settings.myAwesomeModule.foo;
Drupal.settings.myAwesomeModule.bar;
                            </code></pre></li>
                            <li class="fragment">Injected in behaviors' <code>attach</code> and <code>detach</code> functions.<pre><code class="javascript" data-trim>
Drupal.behaviors.doSomething = {
  attach: function(context, settings) {
    settings.myAwesomeModule.foo
  }
}
                                </code></pre></li>
                            </ul>
                        </p>
                    </section>
                    <section id="writing-javascript-summary">
                        <h2>Writing JavaScript</h2>
                        <p>
                                <pre><code class="javascript" data-trim>
(function($) {
  Drupal.behaviors.doSomething = {
    attach: function(context, settings) {
      $('div.something', context).once('do-something').doSomething({
        foo: settings.myAwesomeModule.foo,
        bar: settings.myAwesomeModule.bar
      });
    }
  }
})(jQuery);
                                </code></pre>
                            </p>
                    </section>
                </section>
                <section>
                    <section id="javascript-libraries">
                        <h2>JavaScript Libraries</h2>
                        <p>A library defines a set of <strong>JavaScript files</strong> <span class="fragment">and/or <strong>CSS files</strong></span><span class="fragment">, optionally using <strong>settings</strong></span><span class="fragment">, and optionally <strong>requiring</strong> another library.</span></p>
                    </section>
                    <section id="hook-library">
                        <h2>Declare a library</h2>
                        <p>
                            <pre><code class="php" data-trim>
/**
 * Implements hook_library()
 */
awesome_library() {
  return array(
    'awesomeness' => array(
      'title' => 'Awesome Library',
      'website' => 'http://aweso.me/',
      'version' => '1.0.0'
      'js' => array($data => $options),
      'css' => array($data => $options),
      'dependencies' => array(
        array($module, $library),
      )
    ),
  )
}
                            </code></pre>
                        </p>
                    </section>
                    <section id="drupal-add-library">
                        <h2>Using a library</h2>
                        <p>
                            <pre><code class="php" data-trim>drupal_add_library($module, $library)</code></pre>
                        </p>
                    </section>
                    <section id="core-libraries">
                        <h2>Libraries bundled with Drupal core</h2>
                        <ul>
                            <li><a href="http://api.drupal.org/api/drupal/includes--ajax.inc/group/ajax/7">Drupal AJAX</a></li>
                            <li><a href="http://jquery.com">jQuery</a></li>
                            <li><a href="http://plugins.jquery.com/once">jQuery Once</a></li>
                            <li><a href="http://malsup.com/jquery/form/">jQuery Forms</a></li>
                            <li><a href="http://benalman.com/projects/jquery-bbq-plugin/">jQuery BBQ</a></li>
                            <li><a href="http://plugins.jquery.com/cookie">jQuery Cookie</a></li>
                            <li><a href="http://jqueryui.com">jQuery UI</a></li>
                            <li><a href="http://code.google.com/p/farbtastic/">Farbtastic</a></li>
                        </ul>
                    </section>
                </section>
                <section>
                    <section id="library-api">
                        <h2>Library API</h2>
                        <ul>
                            <li>The same library can be shared by more than one module.</li>
                            <li>The same library can be shared by more than one site.</li>
                            <li>Ease the process of upgrading a module that requires an external library.</li>
                            <li>Prevent incompatibilities due to having the same library installed more than once in different versions.</li>
                            <li>Central installation instructions (widget) to help users figure out how to install.</li>
                            <li>Library classification.</li>
                            <li>Dependency handling.</li>
                            <li>Library version detection.</li>
                            <li>Runtime control of library availability.</li>
                        </ul>
                    </section>
                    <section id="hook-libray-info">
                        <h2>Declare an external library</h2>
                        <pre><code class="php" data-trim>
/**
 * Implements hook_libraries_info()
 */
function awesome_libraries_info() {
  return array(
  'awesome' => array(
    'name' => 'Awesome Library',
    'vendor url' => 'http://aweso.me',
    'download url' => 'https://github.com/awesome/awesomejs/zipball/latest',
    'version arguments' => array(
      'file' => 'package.json',
      'pattern' => '/"version": "(.*)"/',
    ),
    'files' => array('js' => array('awesome.min.js')),
  );
);</code></pre>
                    </section>
                    <section id="hook-library-external">
                        <h2>Declare an external library (2)</h2>
                        <pre><code class="php" data-trim>
/**
 * Implements hook_library()
 */
function awesome_library() {
  $libraries = array();
  if (($library = libraries_detect('awesome')) && $library['installed']) {
    $libraries['awesome'] = array(
      'title' => $library['name'],
      'website' => $library['vendor url'],
      'version' => $library['version'],
      'js' => array(
        library['library path'] . '/' . $library['files']['js'][0]
      )
    );
  }
  return $libraries
}
</code></pre>
                    </section>
                </section>
                <section id="the-end">
                    <h2>The end</h2>
                    <p>
                            <pre><code class="javascript" data-trim>
(function($) {
  Drupal.behaviors.doSomething = {
    attach: function(context, settings) {
      $('div.something', context).once('do-something').doSomething({
        foo: settings.myAwesomeModule.foo,
        bar: settings.myAwesomeModule.bar
      });
    }
  }
})(jQuery);
                            </code></pre>
                        </p>
                </section>
            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>

        <script>

            // Full list of configuration options available here:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                theme: Reveal.getQueryHash().theme || 'solarized', // available themes are in /css/theme
                transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

                // Optional libraries used to extend on reveal.js
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
                    { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
                ]
            });

        </script>

    </body>
</html>
